<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†åå° - åˆ›ä½œç©ºé—´</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Quill.js å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ -->
    <link href="https://unpkg.com/quill@1.3.6/dist/quill.snow.css" rel="stylesheet">
    <!-- å¤‡ç”¨CDN -->
    <link href="https://cdn.jsdelivr.net/npm/quill@1.3.6/dist/quill.snow.css" rel="stylesheet" onerror="this.onerror=null;this.href='https://cdnjs.cloudflare.com/ajax/libs/quill/1.3.6/quill.snow.css';">
</head>
<body class="admin-page">
<!-- é¡µé¢åŠ è½½åŠ¨ç”» -->
<div class="page-loading" id="page-loading">
    <div class="loading-content">
        <div class="loading-spinner"></div>
        <div class="loading-text">æ­£åœ¨åŠ è½½ç®¡ç†åå°...</div>
    </div>
</div>

<header>
    <nav>
        <div class="logo">
            <i class="fas fa-palette"></i>
            <span class="logo-text">åˆ›ä½œç©ºé—´</span>
            <span class="admin-badge">ç®¡ç†åå°</span>
        </div>
        <div class="nav-links">
            <a href="index.html" class="nav-item">
                <i class="fas fa-home"></i>
                <span>è¿”å›é¦–é¡µ</span>
            </a>
            <a href="#" id="logout-link" class="nav-item">
                <i class="fas fa-sign-out-alt"></i>
                <span>é€€å‡º</span>
            </a>
        </div>
    </nav>
</header>

<div class="admin-container">
    <!-- èƒŒæ™¯è£…é¥°å…ƒç´  -->
    <div class="admin-background">
        <div class="floating-shapes">
            <div class="shape shape-1"></div>
            <div class="shape shape-2"></div>
            <div class="shape shape-3"></div>
            <div class="shape shape-4"></div>
        </div>
    </div>

    <div class="admin-header">
        <div class="header-content">
            <h1 class="admin-title">
                <i class="fas fa-crown"></i>
                <span>å†…å®¹ç®¡ç†ä¸­å¿ƒ</span>
            </h1>
            <p class="admin-subtitle">ç®¡ç†æ‚¨çš„åˆ›ä½œå†…å®¹ï¼Œè®©åˆ›æ„ç»½æ”¾å…‰å½©</p>
        </div>
        <div class="admin-actions">
            <button class="btn-modern btn-primary" onclick="openModal('article')">
                <i class="fas fa-plus"></i>
                <span>æ–°å»ºæ–‡ç« </span>
            </button>
            <button class="btn-modern btn-success" onclick="openModal('image')">
                <i class="fas fa-images"></i>
                <span>åˆ›å»ºç›¸å†Œ</span>
            </button>
        </div>
    </div>

    <div class="content-tabs">
        <div class="tab-buttons">
            <button class="tab-btn active" onclick="switchTab('articles')" id="articles-tab-btn">
                <i class="fas fa-newspaper"></i>
                <span>æ–‡ç« ç®¡ç†</span>
                <span class="tab-count">(<span id="articles-count">0</span>)</span>
            </button>
            <button class="tab-btn" onclick="switchTab('images')" id="images-tab-btn">
                <i class="fas fa-images"></i>
                <span>ç›¸å†Œç®¡ç†</span>
                <span class="tab-count">(<span id="images-count">0</span>)</span>
            </button>
        </div>

        <div id="articles-tab" class="tab-content active">
            <div class="content-header">
                <div class="stats-card">
                    <div class="stats-info" id="articles-stats">
                        <i class="fas fa-newspaper"></i>
                        <span>æ­£åœ¨åŠ è½½ç»Ÿè®¡ä¿¡æ¯...</span>
                    </div>
                </div>
                <div class="search-controls">
                    <div class="search-container">
                        <i class="fas fa-search"></i>
                        <input type="text" class="search-box" placeholder="æœç´¢æ–‡ç« ..." id="articles-search" onkeyup="searchContent('articles')">
                    </div>
                </div>
            </div>
            <div id="articles-container" class="content-grid">
                <div class="loading">
                    <div class="spinner"></div>
                    <span>æ­£åœ¨åŠ è½½æ–‡ç« åˆ—è¡¨...</span>
                </div>
            </div>
            <div id="articles-pagination" class="pagination"></div>
        </div>

        <div id="images-tab" class="tab-content">
            <div class="content-header">
                <div class="stats-card">
                    <div class="stats-info" id="images-stats">
                        <i class="fas fa-images"></i>
                        <span>æ­£åœ¨åŠ è½½ç»Ÿè®¡ä¿¡æ¯...</span>
                    </div>
                </div>
                <div class="search-controls">
                    <div class="search-container">
                        <i class="fas fa-search"></i>
                        <input type="text" class="search-box" placeholder="æœç´¢ç›¸å†Œ..." id="images-search" onkeyup="searchContent('images')">
                    </div>
                </div>
            </div>
            <div id="images-container" class="content-grid">
                <div class="loading">
                    <div class="spinner"></div>
                    <span>æ­£åœ¨åŠ è½½ç›¸å†Œåˆ—è¡¨...</span>
                </div>
            </div>
            <div id="images-pagination" class="pagination"></div>
        </div>
    </div>
</div>

<!-- æ–‡ç« æ¨¡æ€æ¡† -->
<div id="article-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title" id="article-modal-title">
                <i class="fas fa-edit"></i>
                æ–°å»ºæ–‡ç« 
            </h3>
            <button class="close-btn" onclick="closeModal('article')">&times;</button>
        </div>
        <form id="article-form">
            <div class="form-group">
                <label class="form-label" for="article-title">
                    <i class="fas fa-heading"></i>
                    æ–‡ç« æ ‡é¢˜ *
                </label>
                <input type="text" class="form-input" id="article-title" name="title" placeholder="è¯·è¾“å…¥æ–‡ç« æ ‡é¢˜" required>
            </div>
            <div class="form-group">
                <label class="form-label" for="article-category">
                    <i class="fas fa-tag"></i>
                    åˆ†ç±»
                </label>
                <select class="form-input" id="article-category" name="category">
                    <option value="">è¯·é€‰æ‹©åˆ†ç±»</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">
                    <i class="fas fa-align-left"></i>
                    æ–‡ç« å†…å®¹ *
                </label>
                <div id="article-content-editor" class="quill-editor">
                    <p>è¯·è¾“å…¥æ–‡ç« å†…å®¹...</p>
                </div>
                <textarea id="article-content" style="display: none;"></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">
                    <i class="fas fa-image"></i>
                    å°é¢å›¾ç‰‡
                </label>
                <div class="file-upload-area" onclick="document.getElementById('article-image-file').click()">
                    <div class="upload-icon">ğŸ“·</div>
                    <div class="upload-text">ç‚¹å‡»é€‰æ‹©å°é¢å›¾ç‰‡</div>
                    <div class="upload-hint">æ”¯æŒ JPGã€PNGã€GIFã€WebP æ ¼å¼ï¼Œæœ€å¤§ 5MB</div>
                </div>
                <input type="file" id="article-image-file" accept="image/*" style="display: none;" onchange="handleArticleImageSelect(event)">
                <input type="hidden" id="article-cover-image" name="cover-image">
                <div id="article-image-preview" class="preview-grid" style="display: none; margin-top: 15px;"></div>
            </div>
        </form>
        <div class="modal-footer">
            <button type="button" class="btn-modern btn-secondary" onclick="closeModal('article')">
                <i class="fas fa-times"></i>
                å–æ¶ˆ
            </button>
            <button type="button" class="btn-modern btn-success" onclick="saveArticle()" id="save-article-btn">
                <i class="fas fa-save"></i>
                ä¿å­˜æ–‡ç« 
            </button>
        </div>
    </div>
</div>

<!-- ç›¸å†Œæ¨¡æ€æ¡† -->
<div id="image-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title">
                <i class="fas fa-images"></i>
                åˆ›å»ºç›¸å†Œ
            </h3>
            <button class="close-btn" onclick="closeModal('image')">&times;</button>
        </div>
        <form id="image-form">
            <div class="form-group">
                <label class="form-label" for="image-title">
                    <i class="fas fa-heading"></i>
                    ç›¸å†Œæ ‡é¢˜
                </label>
                <input type="text" class="form-input" id="image-title" name="title" placeholder="è¯·è¾“å…¥ç›¸å†Œæ ‡é¢˜">
            </div>
            <div class="form-group">
                <label class="form-label" for="image-category">
                    <i class="fas fa-tag"></i>
                    ç›¸å†Œåˆ†ç±»
                </label>
                <select class="form-input" id="image-category" name="category">
                    <option value="">è¯·é€‰æ‹©åˆ†ç±»</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">
                    <i class="fas fa-upload"></i>
                    é€‰æ‹©å›¾ç‰‡æ–‡ä»¶ *
                </label>
                <div class="file-upload-area" onclick="document.getElementById('image-files').click()" 
                     ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                    <div class="upload-icon">ğŸ–¼ï¸</div>
                    <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
                    <div class="upload-hint">æ”¯æŒå¤šæ–‡ä»¶é€‰æ‹© | JPGã€PNGã€GIFã€WebP | å•æ–‡ä»¶æœ€å¤§ 5MB</div>
                </div>
                <input type="file" id="image-files" accept="image/*" multiple style="display: none;" onchange="handleMultipleFileSelect(event)">
                <div id="images-preview-container" class="preview-grid" style="display: none; margin-top: 15px;"></div>
            </div>
            <div class="form-group">
                <label class="form-label" for="image-description">
                    <i class="fas fa-align-left"></i>
                    ç›¸å†Œæè¿°
                </label>
                <textarea class="form-input form-textarea" id="image-description" name="description" placeholder="è¯·è¾“å…¥ç›¸å†Œæè¿°ï¼ˆå¯é€‰ï¼‰"></textarea>
            </div>
            <div id="upload-progress" style="display: none; margin-top: 20px;">
                <div class="upload-progress-title">
                    <i class="fas fa-cloud-upload-alt"></i>
                    ä¸Šä¼ è¿›åº¦
                </div>
                <div id="upload-progress-list"></div>
                <div id="upload-summary" class="upload-summary"></div>
            </div>
        </form>
        <div class="modal-footer">
            <button type="button" class="btn-modern btn-secondary" onclick="closeModal('image')">
                <i class="fas fa-times"></i>
                å–æ¶ˆ
            </button>
            <button type="button" class="btn-modern btn-success" onclick="saveImages()" id="save-images-btn" disabled>
                <i class="fas fa-save"></i>
                åˆ›å»ºç›¸å†Œ
            </button>
        </div>
    </div>
</div>

<!-- å¿«æ·åŠŸèƒ½é¢æ¿ -->
<div class="quick-actions">
    <button class="quick-btn" onclick="scrollToTop()" title="è¿”å›é¡¶éƒ¨">
        <i class="fas fa-arrow-up"></i>
    </button>
    <button class="quick-btn" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">
        <i class="fas fa-moon"></i>
    </button>

</div>

<div id="notification" class="notification"></div>

<!-- Quill.js å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ -->
<script src="https://unpkg.com/quill@1.3.6/dist/quill.min.js"></script>
<!-- å¤‡ç”¨CDN -->
<script>
// æ£€æŸ¥Quillæ˜¯å¦åŠ è½½æˆåŠŸï¼Œå¦‚æœå¤±è´¥åˆ™å°è¯•å¤‡ç”¨CDN
if (typeof Quill === 'undefined') {
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/quill@1.3.6/dist/quill.min.js';
    script.onerror = function() {
        // å¦‚æœå¤‡ç”¨CDNä¹Ÿå¤±è´¥ï¼Œå°è¯•ç¬¬ä¸‰ä¸ªCDN
        const fallbackScript = document.createElement('script');
        fallbackScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/quill/1.3.6/quill.min.js';
        fallbackScript.onerror = function() {
            console.error('æ‰€æœ‰Quill.js CDNéƒ½åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¦ç”¨å¹¿å‘Šæ‹¦æˆªå™¨');
            // æ˜¾ç¤ºé”™è¯¯æç¤º
            const notification = document.getElementById('notification');
            if (notification) {
                notification.textContent = 'å¯Œæ–‡æœ¬ç¼–è¾‘å™¨åŠ è½½å¤±è´¥ï¼Œè¯·ç¦ç”¨å¹¿å‘Šæ‹¦æˆªå™¨æˆ–åˆ·æ–°é¡µé¢é‡è¯•';
                notification.className = 'notification error show';
            }
        };
        document.head.appendChild(fallbackScript);
    };
    document.head.appendChild(script);
}
</script>
<script src="assets/js/app.js"></script>
<script src="assets/js/utils.js"></script>
<script src="assets/js/api-client.js"></script>
<script src="assets/js/admin.js"></script>
</body>
</html>
